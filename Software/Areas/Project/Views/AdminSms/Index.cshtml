@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@model DTO.Project.SmsManager.AdminSmsIndexViewModel

@{
    ViewData["Title"] = "مدیریت و ارسال پیامک";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}

<div class="card mb-3">
    <div class="card-header d-flex flex-wrap justify-content-between align-items-center gap-2">
        <h5 class="mb-0">
            <i class="bi bi-chat-dots"></i>
            مدیریت و ارسال پیامک
        </h5>

        <div class="d-flex flex-wrap gap-2">
            <button type="button"
                    class="btn btn-primary"
                    onclick="smsAdmin.single.loadForm()">
                <i class="bi bi-send"></i>
                ارسال تکی
            </button>

            <button type="button"
                    class="btn btn-secondary"
                    onclick="smsAdmin.bulk.loadForm()">
                <i class="bi bi-list-check"></i>
                ارسال به فهرست شماره‌ها
            </button>

            <button type="button"
                    class="btn btn-info text-white"
                    onclick="smsAdmin.groups.loadForm()">
                <i class="bi bi-people"></i>
                ارسال به گروه‌های مخاطب
            </button>

            <button type="button"
                    class="btn btn-warning"
                    onclick="smsAdmin.file.loadForm()">
                <i class="bi bi-file-earmark-arrow-up"></i>
                ارسال از فایل
            </button>
        </div>
    </div>

    <div class="card-body">

        <!-- فیلترها -->
        <form id="sms-filter-form" class="row g-3 mb-3">
            <div class="col-12 col-md-3">
                <label class="form-label">سرشماره</label>
                <select id="filter-senderNumber"
                        class="form-select zbm-control">
                    <option value="">همه سرشماره‌ها</option>
                    @foreach (var item in Model.SenderNumberOptions)
                    {
                        <option value="@item.Value">@item.Text</option>
                    }
                </select>
            </div>

            <div class="col-12 col-md-3">
                <label class="form-label">وضعیت</label>
                <select id="filter-status"
                        class="form-select zbm-control">
                    @foreach (var item in Model.StatusOptions)
                    {
                        <option value="@item.Value">@item.Text</option>
                    }
                </select>
            </div>

            <div class="col-12 col-md-3">
                <label class="form-label">کانال</label>
                <select id="filter-channel"
                        class="form-select zbm-control">
                    @foreach (var item in Model.ChannelOptions)
                    {
                        <option value="@item.Value">@item.Text</option>
                    }
                </select>
            </div>

            <div class="col-12 col-md-3">
                <label class="form-label">جستجو در متن / شماره</label>
                <input id="filter-search"
                       class="form-control zbm-control"
                       placeholder="شماره گیرنده، متن، کاربر..." />
            </div>

            <div class="col-12 col-md-3">
                <label class="form-label">از تاریخ</label>

                <input id="filter-from-view"
                       type="text"
                       class="form-control zbm-control persian-date-input"
                       autocomplete="off"
                       placeholder="مثال: ۱۴۰۳/۰۹/۱۰" />

                <input id="filter-from"
                       name="From"
                       type="hidden" />
            </div>

            <div class="col-12 col-md-3">
                <label class="form-label">تا تاریخ</label>

                <input id="filter-to-view"
                       type="text"
                       class="form-control zbm-control persian-date-input"
                       autocomplete="off"
                       placeholder="مثال: ۱۴۰۳/۰۹/۲۰" />

                <input id="filter-to"
                       name="To"
                       type="hidden" />
            </div>

            <div class="col-12 col-md-3 d-flex align-items-end">
                <div class="form-check">
                    <input class="form-check-input"
                           type="checkbox"
                           id="filter-onlyOutbound"
                           checked />
                    <label class="form-check-label" for="filter-onlyOutbound">
                        فقط خروجی (Outbound)
                    </label>
                </div>
            </div>

            <div class="col-12 col-md-3 d-flex align-items-end justify-content-end gap-2">
                <button type="button"
                        class="btn btn-outline-primary"
                        onclick="smsAdmin.filter.apply()">
                    جستجو
                </button>
                <button type="button"
                        class="btn btn-outline-secondary"
                        onclick="smsAdmin.filter.reset()">
                    پاک‌سازی
                </button>
            </div>
        </form>

        <!-- جدول لاگ پیامک‌ها -->
        <table id="sms-history-table"
               class="table table-striped table-bordered w-100">
            <thead>
                <tr>
                    <th>id</th>
                    <th>سرشماره</th>
                    <th>کاربر ثبت‌کننده</th>
                    <th>شماره گیرنده</th>
                    <th>متن پیام</th>
                    <th>وضعیت</th>
                    <th>جهت</th>
                    <th>کانال</th>
                    <th>تاریخ ثبت</th>
                    <th>تاریخ ارسال</th>
                    <th>تاریخ تحویل</th>
                    <th>هزینه رزرو</th>
                    <th>هزینه نهایی</th>
                    <th>علت خطا</th>
                </tr>
            </thead>
        </table>

    </div>
</div>

@section Scripts {
    @await Html.PartialAsync("_ValidationScriptsPartial")

    <script src="~/areas/project/smsadmin.js"></script>
}

