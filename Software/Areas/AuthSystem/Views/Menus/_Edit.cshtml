@model Domain.Entities.Menu

<div class="modal-header border-0">
    <h5 class="modal-title fw-bold">
        <i class="bi bi-pencil-square text-primary"></i>
        ویرایش منو
        @if (ViewBag.ParentName != null)
        {
            <span class="text-muted"> (زیرمنوی "@ViewBag.ParentName") </span>
        }
    </h5>

    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
</div>

<div class="modal-body px-3">

    <p class="text-muted small text-center mb-3">
        پرکردن فیلدهای ستاره‌دار الزامی است.
    </p>

    <form asp-action="Edit" class="edit-form" onsubmit="return menu.edit.save(event)">
        <input type="hidden" asp-for="Id" />
        <input type="hidden" asp-for="ParentId" />
        <input type="hidden" id="Parameters" name="Parameters" value="@Model.Parameters" />

        <div asp-validation-summary="ModelOnly" class="text-danger text-center"></div>
        <div class="error text-center text-danger edit-error">@ViewBag.Error</div>


        <!-- ===== اطلاعات اصلی ===== -->
        <div class="row g-3">

            <div class="col-md-4">
                <label asp-for="Title" class="form-label required"></label>
                <input asp-for="Title" class="form-control form-control-custom" />
                <span asp-validation-for="Title" class="text-danger small"></span>
            </div>

            <div class="col-md-4">
                <label asp-for="Sort" class="form-label required"></label>
                <input asp-for="Sort" class="form-control form-control-custom" />
                <span asp-validation-for="Sort" class="text-danger small"></span>
            </div>

            <div class="col-md-4">
                <label asp-for="MaterialIcon" class="form-label"></label>
                <input asp-for="MaterialIcon" class="form-control form-control-custom" placeholder="مثال: bi bi-gear" />
                <span asp-validation-for="MaterialIcon" class="text-danger small"></span>
            </div>

        </div>


        <!-- ===== سوییچ‌ها ===== -->
        <div class="row g-3 mt-3">

            <div class="col-md-3">
                <label class="form-label d-block">فعال باشد</label>
                <div class="form-check form-switch">
                    <input asp-for="IsEnabled" class="form-check-input" />
                </div>
            </div>

            <div class="col-md-3">
                <label class="form-label d-block">در منوی سایت نمایش داده شود؟</label>
                <div class="form-check form-switch">
                    <input asp-for="ShowInMenu" class="form-check-input" />
                </div>
            </div>

            <div class="col-md-3">
                <label class="form-label d-block">لینک دارد؟</label>
                <div class="form-check form-switch">
                    <input asp-for="HasLink" class="form-check-input"
                           onchange="toggleSlide(this,'#link-section')" />
                </div>
            </div>

            <div class="col-md-3">
                <label class="form-label d-block">نیاز به احراز هویت مجدد؟</label>
                <div class="form-check form-switch">
                    <input asp-for="NeedReAuthorize" class="form-check-input" />
                </div>
            </div>

        </div>


        <!-- ===== بخش لینک ===== -->
        <div id="link-section" class="mt-4" style="display:@(Model.HasLink ? "block" : "none")">

            <h6 class="fw-bold border-bottom pb-2 mb-3">لینک منو</h6>

            <div class="row g-3">

                <div class="col-md-4">
                    <label asp-for="Area" class="form-label"></label>
                    <input asp-for="Area" class="form-control form-control-custom ltr" />
                    <span asp-validation-for="Area" class="text-danger small"></span>
                </div>

                <div class="col-md-4">
                    <label asp-for="Controller" class="form-label"></label>
                    <input asp-for="Controller" class="form-control form-control-custom ltr" />
                    <span asp-validation-for="Controller" class="text-danger small"></span>
                </div>

                <div class="col-md-4">
                    <label asp-for="Action" class="form-label"></label>
                    <input asp-for="Action" class="form-control form-control-custom ltr" />
                    <span asp-validation-for="Action" class="text-danger small"></span>
                </div>

            </div>


            <!-- پارامترهای داینامیک -->
            <div class="parameters-section mt-4">
                <h6 class="fw-bold border-bottom pb-2 mb-3">پارامترهای اضافه</h6>

                <div class="card border rounded">
                    <div class="card-body">
                        <!-- آیتم‌ها داینامیک اینجا توسط JS اضافه می‌شود -->
                    </div>

                    <div class="card-footer text-center bg-light">
                        <button type="button" class="btn btn-primary btn-sm" onclick="menu.parameters.add()">
                            <i class="bi bi-plus-lg"></i>
                            افزودن پارامتر جدید
                        </button>
                    </div>
                </div>

            </div>

        </div>


        <!-- ===== توضیحات ===== -->
        <div class="mt-4">
            <label asp-for="Description" class="form-label"></label>
            <textarea asp-for="Description" class="form-control form-control-custom" rows="3"></textarea>
            <span asp-validation-for="Description" class="text-danger small"></span>
        </div>


        <!-- ===== دکمه‌های نهایی ===== -->
        <div class="text-center mt-4">

            <button type="submit" class="btn btn-success px-4">
                <i class="bi bi-check-circle"></i>
                ذخیره تغییرات
            </button>

            <button type="button" class="btn btn-outline-secondary px-4" data-bs-dismiss="modal">
                بستن
            </button>

        </div>

    </form>

</div>
