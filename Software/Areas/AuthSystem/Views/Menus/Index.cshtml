@model IEnumerable<Domain.Entities.Menu>

@{
    ViewData["Title"] = "مدیریت منوها";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}

<div class="container-fluid">

    <!-- ===== Header ===== -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h4 class="fw-bold">
            <i class="bi bi-list-ul text-primary"></i>
            مدیریت منوها
        </h4>

        <button class="btn btn-success px-3 shadow-sm" onclick="menu.create.loadForm()">
            <i class="bi bi-plus-circle"></i>
            منوی جدید
        </button>
    </div>

    <!-- ===== Card ===== -->
    <div class="card shadow-sm border-0">

        <div class="card-header bg-light fw-bold">
            ساختار منوها
        </div>

        <div class="card-body">

            <!-- دکمه‌های عملیات -->
            <div class="d-flex gap-2 mb-3">

                <button class="btn btn-primary edit-btn hide"
                        onclick="menu.edit.loadForm()">
                    <i class="bi bi-pencil-square"></i>
                    ویرایش
                </button>

                <button class="btn btn-danger delete-btn hide"
                        onclick="menu.delete.loadForm()">
                    <i class="bi bi-trash"></i>
                    حذف
                </button>

            </div>

            <!-- TreeView -->
            <div id="treeview" class="border rounded p-3 bg-white shadow-sm"></div>

        </div>
    </div>

    <!-- ===== Modal ===== -->
    <div class="modal fade" id="base-modal" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content" id="modal-form"></div>
        </div>
    </div>

</div>


@section Scripts {

    <script>
        var controller = "Menus";
    </script>

    @await Html.PartialAsync("_ValidationScriptsPartial")

    <script src="~/assets/bootstrap-treeview/bootstrap-treeview.min.js"></script>
    <script src="~/assets/js/jquery.datatables.js"></script>

    <script src="~/Areas/AuthSystem/js/Menu.js" asp-append-version="true"></script>
}



@section Styles {
    <link href="~/assets/bootstrap-treeview/bootstrap-treeview.min.css" rel="stylesheet" />

    <style>

        /* ===== TreeView UI Modern Design ===== */

        #treeview {
            min-height: 400px;
            border-radius: 12px;
            background: var(--bg-sidebar);
            transition: .2s;
        }

        /* لیست گره‌ها */
        .treeview .list-group-item {
            border: none !important;
            padding: 10px 14px;
            cursor: pointer;
            background: transparent;
            transition: .2s;
        }

            .treeview .list-group-item:hover {
                background: var(--primary-soft);
            }

            /* آیکن + عنوان */
            .treeview .list-group-item i,
            .treeview .list-group-item span.node-title {
                float: right;
                margin-left: 8px;
                font-size: 14px;
                font-weight: 600;
            }

        .treeview .node-selected {
            background: var(--primary) !important;
            color: #fff !important;
            border-radius: 8px;
        }

        /* ===== Dark Mode Compatibility ===== */
        body.dark #treeview {
            background: #1e1e1e;
            border-color: #333;
        }

        body.dark .treeview .list-group-item:hover {
            background: #2d2d2d;
        }

        body.dark .node-selected {
            background: var(--primary) !important;
        }


        /* حذف پارامتر */
        .parameters-section .delete {
            transform: translateY(12px);
        }

            .parameters-section .delete i {
                font-size: 22px;
            }

    </style>
}
